<Window x:Class="TechDashboard.Views.IconPickerDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:lex="http://wpflocalizeextension.codeplex.com"
        xmlns:icons="clr-namespace:TechDashboard.Core.Constants"
        Title="{lex:Loc IconPicker_Title}"
        SizeToContent="WidthAndHeight"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource WindowBackgroundBrush}"
        AllowsTransparency="True"
        WindowStyle="None"
        SnapsToDevicePixels="True">
    <Border BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="8" Padding="12">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <DockPanel Grid.Row="0" LastChildFill="False">
                <TextBlock Text="{lex:Loc IconPicker_Title}" FontSize="16" FontWeight="Bold" Foreground="{DynamicResource TextBrush}"/>
                <Button Content="âœ•" Style="{StaticResource WindowControlButtonStyle}" Click="Close_Click" DockPanel.Dock="Right"/>
            </DockPanel>

            <!-- Controls -->
            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,8,0,8">
                <ComboBox Width="180" ItemsSource="{Binding Categories}" SelectedItem="{Binding SelectedCategory}"/>
                <TextBox Width="240" Margin="8,0,0,0" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"/>
                <Button Style="{StaticResource ToolbarButtonStyle}" Margin="8,0,0,0" Command="{Binding CopyXamlCommand}">
                    <TextBlock Text="{x:Static icons:IconConstants+Common.Copy}" FontFamily="{x:Static icons:IconConstants.DefaultFontFamily}"/>
                </Button>
                <Button Style="{StaticResource ToolbarButtonStyle}" Margin="4,0,0,0" Command="{Binding CopyCSharpCommand}">
                    <TextBlock Text="{x:Static icons:IconConstants+Tools.Code}" FontFamily="{x:Static icons:IconConstants.DefaultFontFamily}"/>
                </Button>
            </StackPanel>

            <!-- Grid -->
            <ScrollViewer Grid.Row="2" Width="640" Height="420">
                <ItemsControl ItemsSource="{Binding FilteredIcons}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Style="{StaticResource DashboardCard}" Width="140" Height="110" Margin="6" Padding="8">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <StackPanel Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,0,4">
                                        <TextBlock Text="{Binding Value}" FontFamily="{x:Static icons:IconConstants.DefaultFontFamily}" FontSize="26" HorizontalAlignment="Center"/>
                                        <TextBlock Text="{Binding Key}" FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}" TextTrimming="CharacterEllipsis" HorizontalAlignment="Center" MaxWidth="120"/>
                                    </StackPanel>
                                    <Button Grid.Row="1" Margin="0" Width="32" Height="28" Style="{StaticResource ToolbarButtonStyle}" Background="Transparent" BorderThickness="0"
                                            Command="{Binding DataContext.SelectIconCommand, RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}">
                                        <TextBlock Text="{x:Static icons:IconConstants+Common.CheckMark}" FontFamily="{x:Static icons:IconConstants.DefaultFontFamily}" FontSize="16"/>
                                    </Button>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>

            <!-- Footer -->
            <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right">
                <TextBlock Text="XAML:" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,6,0"/>
                <TextBox Width="260" Text="{Binding SelectedXaml}" IsReadOnly="True"/>
                <TextBlock Text="C#:" Foreground="{DynamicResource TextSecondaryBrush}" Margin="12,0,6,0"/>
                <TextBox Width="260" Text="{Binding SelectedCSharp}" IsReadOnly="True"/>
            </StackPanel>
        </Grid>
    </Border>
</Window>
